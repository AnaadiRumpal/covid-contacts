<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="shortcut icon" type="image/jpg" href="lettera.png"/>
  <link rel="stylesheet" href="lp.css">
  <title>Anaadi Rumpal</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
  

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>COVID-19 Dashboard</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    #map {
      height: 400px;
    }
  </style>
</head>
<body>

    

    <div id="charts" class=" flex flex-col justify-center items-center w-5/6 bgimage bg-fixed bg-cover ">

        


        <div class="p-8 flex-col flex  items-center  ">
            <div class="cardcont duration-75 flex flex-col w-4/5 backdrop-blur-xl items-center bg-white/80 rounded-xl ">
                <p  class=" text-2xl font-semibold p-6"> COVID-19 DASHBOARD</p>

            </div>
        </div>

        <div class="p-24 flex-col flex w-full items-center  ">
            <div class="cardcont duration-75 p-8 flex flex-col w-full backdrop-blur-xl items-center bg-white/80 rounded-xl ">
                <p  class=" text-2xl font-semibold p-4 pb-8"> Cases Fluctuations</p>
                <canvas id="lineChart" width="400" height="200"></canvas>

            </div>
        </div>

        <div class="p-24 flex-col flex w-full items-center  ">
            <div class="cardcont duration-75 p-8  flex flex-col w-full backdrop-blur-xl  bg-white/80 rounded-xl ">
                <p  class=" text-2xl font-semibold p-4 pb-8"> Global COVID-19 Statistics</p>
                <div class="w-full p-4 gap-2 flex-row items-center rounded-full bg-slate-50 text-lg">
                    <label for="countrySelect"  >  Select a Country:</label>
                    <select id="countrySelect"  class="bg-slate-200  rounded-full p-2">select country</select>
                    <button id="fetchCountryData" class="p-1.5  rounded-full w-1/4 text-white bg-sky-400 hover:bg-sky-500" >Fetch Data</button>
                </div>
                <div id="countryData" style="margin-top: 20px;"></div>

                
                <div id="stats" class="  flex  flex-wrap  flex-row">
                    <div class=" flex w-1/2 p-2">
                        <div class="flex-col w-full p-3  rounded-lg">
                            <div class="flex  mb-1">
                                <p id = "countryhead"class="text-3xl font-bold text-black "></p>
                            </div>
                            <div class="w-full  rounded-full  bg-gray-700">
                                <!-- <img src="${country.countryInfo.flag}" alt="${country.country}" width="200">                     -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex flex-col w-1/2 p-2">
                        <div class="flex-col w-full p-3 bg-white/40 rounded-lg">
                            <div class="flex justify-between  mb-1">
                                <span id = "testsnum" class="text-xl font-medium text-black ">Tests : 224928</span>
                                <span class="text-sm  font-normal mt-auto text-black ">Population</span>
                            </div>
                            <div class="w-full mt-3 rounded-full h-4 bg-gray-600">
                                <div id ="testsbar" class="bg-blue-500 h-4 rounded-full"></div>
                            </div>
                        </div>
                        <div class="flex-col w-full p-3 bg-white/40 rounded-lg">
                            <div class="flex justify-between  mb-1">
                                <span id="casesnum" class="text-xl font-medium text-black ">Cases : 224928</span>
                                <span class="text-sm  font-normal mt-auto text-black ">Tests</span>
                            </div>
                            <div class="w-full mt-3 rounded-full h-4 bg-gray-600">
                                <div id = "casesbar" class="bg-blue-500 h-4 rounded-full"></div>
                            </div>
                        </div>

                    </div>

                    <div class="flex w-1/2 p-2">
                        <div class="flex-col flex w-full p-3 justify-between  bg-white/40 rounded-lg">
                            <div class="flex  ">
                                <span id="popact" class="text-xl  font-medium text-black ">Population : 40754388 <br> Active : 11648</span>

                            </div>
                            
                        </div>

                    </div>

                    <div class="flex w-1/2 p-2">
                        <div class="flex-col w-full p-3 bg-white/40 rounded-lg">
                            <div class="flex justify-between  mb-1">
                                <span id ="activenum"class="text-xl font-medium text-black ">Active : 11648</span>
                                <span class="text-sm  font-normal mt-auto text-black ">Cases</span>
                            </div>
                            <div class="w-full mt-3 rounded-full h-4 bg-gray-600">
                                <div id ="activebar"class="bg-blue-500 h-4 rounded-full"></div>
                            </div>
                        </div>

                    </div>

                    <div class="flex  w-1/2 p-2">
                        <div class="flex-col w-full p-3 bg-white/40 rounded-lg">
                            <div class="flex justify-between  mb-1">
                                <span id="deathsnum" class="text-xl font-medium text-black ">Deaths : 7942</span>
                                <span class="text-sm  font-normal mt-auto text-black ">Cases</span>
                            </div>
                            <div class="w-full mt-3 rounded-full h-4 bg-gray-600">
                                <div id="deathbar" class="bg-red-400 h-4 rounded-full"></div>
                            </div>
                        </div>

                    </div>

                    <div class="flex  w-1/2 p-2">
                        <div class="flex-col w-full p-3 bg-white/40 rounded-lg">
                            <div class="flex justify-between  mb-1">
                                <span id ="recovnum"class="text-xl font-medium text-black ">Recovered : 205338</span>
                                <span class="text-sm  font-normal mt-auto text-black ">Cases</span>
                            </div>
                            <div class="w-full mt-3 rounded-full h-4 bg-gray-600">
                                <div id ="recovbar"class="bg-blue-500 h-4 rounded-full"></div>
                            </div>
                        </div>

                    </div>

                    
                    


                    
                </div>
                
                  
            </div>
        </div>

        
        


        
    </div>
  

  



  

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const historicalUrl = "https://disease.sh/v3/covid-19/historical/all?lastdays=all";
    const globalUrl = "https://disease.sh/v3/covid-19/all";
    const countriesUrl = "https://disease.sh/v3/covid-19/countries";

    async function fetchData(url) {
      const response = await fetch(url);
      const data = await response.json();
      return data;
    }

    async function fetchHistoricalData() {
      return fetchData(historicalUrl);
    }

    async function fetchGlobalData() {
      return fetchData(globalUrl);
    }

    async function fetchCountriesData() {
      return fetchData(countriesUrl);
    }

    // Process data and build dashboard
    Promise.all([fetchHistoricalData(), fetchGlobalData(), fetchCountriesData()])
      .then(([historicalData, globalData, countriesData]) => {
        // Build line chart
        const ctx = document.getElementById("lineChart").getContext("2d");
        const dates = Object.keys(historicalData.cases);
        const cases = Object.values(historicalData.cases);
        const deaths = Object.values(historicalData.deaths);
        const recovered = Object.values(historicalData.recovered);

        new Chart(ctx, {
          type: "line",
          data: {
            labels: dates,
            datasets: [
              { label: "Cases", data: cases, borderColor: "blue" },
              { label: "Deaths", data: deaths, borderColor: "red" },
              { label: "Recovered", data: recovered, borderColor: "green" }
            ]
          }
        });

        const countrySelect = document.getElementById("countrySelect");
        countriesData.forEach(country => {
          const option = document.createElement("option");
          option.value = country.country;
          option.textContent = country.country;
          countrySelect.appendChild(option);
        });

        // Fetch and display country data
        const fetchCountryDataButton = document.getElementById("fetchCountryData");
        const countryDataDiv = document.getElementById("countryData");

        const countryhead = document.getElementById("countryhead");
        const testsnum = document.getElementById("testsnum");
        const testsbar = document.getElementById("testsbar");
        const popact = document.getElementById("popact");
        const casesnum = document.getElementById("casesnum");
        const casesbar = document.getElementById("casesbar");
        const deathsnum = document.getElementById("deathsnum");
        const deathsbar = document.getElementById("deathbar");
        const recovnum = document.getElementById("recovnum");
        const recovbar = document.getElementById("recovbar");
        const activenum = document.getElementById("activenum");
        const activebar = document.getElementById("activebar");

        const stats = document.getElementById("stats");
        stats.className = " flex  flex-wrap  flex-row hidden";

        

        
        fetchCountryDataButton.addEventListener("click", async () => {
          const selectedCountry = countrySelect.value;
          const country = countriesData.find(country => country.country === selectedCountry);
          if (country) {
            
            stats.className = " flex  flex-wrap  flex-row block";




            countryhead.innerHTML = `${country.country} <br><br><img src="${country.countryInfo.flag}" alt="${country.country}" width="150">`;
            testsnum.innerHTML = `Tests: ${country.tests}`;
            popact.innerHTML = `Population: ${country.population}`;
            casesnum.innerHTML= `Cases: ${country.cases}`;
            deathsnum.innerHTML = `Deaths: ${country.deaths}`;
            recovnum.innerHTML = `Recovered: ${country.recovered}`;
            activenum.innerHTML = `Active: ${country.active}`;

            testsbar.style.width = `${(country.tests*100/country.population).toFixed(2)}%`;
            casesbar.style.width = `${(country.cases*100/country.tests).toFixed(2)}%`;
            deathsbar.style.width = `${(country.deaths*100/country.cases).toFixed(2)}%`;
            recovbar.style.width = `${(country.recovered*100/country.cases).toFixed(2)}%`;
            activebar.style.width = `${(country.active*100/country.cases).toFixed(2)}%`;

 







          }
        });
            



        // Build Leaflet map
        const map = L.map("map").setView([0, 0], 2);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

        globalData.countries.forEach(country => {
          const marker = L.marker([country.countryInfo.lat, country.countryInfo.long]).addTo(map);
          marker.bindPopup(`
            <b>${country.country}</b><br>
            Active: ${country.active}<br>
            Recovered: ${country.recovered}<br>
            Deaths: ${country.deaths}
          `);
        });
      })
      .catch(error => {
        console.error("Error fetching data:", error);
      });
  </script>
</body>
</html>
